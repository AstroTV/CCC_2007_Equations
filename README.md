Solution for the CCC 2007/2008 from CatCoder
